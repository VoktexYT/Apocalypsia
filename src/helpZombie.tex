
export default class Zombie {
    mesh: THREE.Object3D | null = null;
    mixer: THREE.AnimationMixer | null = null;

    last_action: THREE.AnimationAction | null = null;
    is_finish_load = false;

    walk_animation_speed = randInt(4, 10) / 100;

    animation_name = "";
    
    animationSpeed = 0;




    get_damage(damage: number) {
        this.animation_name = "gethit";
        this.play_animation(this.animation_name, 0.04);
    }
 
    play_animation(animationName: string, speed: number, is_loop?: boolean) {
        this.animationSpeed = speed;

        if (Object.keys(zombie_fbx_loader.animations).includes(animationName) && this.mesh !== null) {
            const mixer = new THREE.AnimationMixer(this.mesh);
            
            const action = mixer.clipAction(zombie_fbx_loader.animations[animationName]);

            if (this.last_action !== null) {
                this.last_action.crossFadeTo(action, 0.5, false);
            }

            if (!is_loop) {
                action.clampWhenFinished = true;
                action.setLoop(THREE.LoopOnce, 0);
            }

            action.play();
            
            this.last_action = action;
            this.mixer = mixer;
        }
    }

    
    update() 
    {
        this.mixer?.update(this.animationSpeed);
    }
}